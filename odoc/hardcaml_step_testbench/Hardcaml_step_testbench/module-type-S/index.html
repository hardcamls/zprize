<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>S (hardcaml_step_testbench.Hardcaml_step_testbench.S)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">hardcaml_step_testbench</a> &#x00BB; <a href="../index.html">Hardcaml_step_testbench</a> &#x00BB; S</nav><header class="odoc-preamble"><h1>Module type <code><span>Hardcaml_step_testbench.S</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module" id="module-I" class="anchored"><a href="#module-I" class="anchor"></a><code><span><span class="keyword">module</span> <a href="I/index.html">I</a></span><span> : <a href="../../../hardcaml/Hardcaml/Interface/module-type-S/index.html">Hardcaml.Interface.S</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-O" class="anchored"><a href="#module-O" class="anchor"></a><code><span><span class="keyword">module</span> <a href="O/index.html">O</a></span><span> : <a href="../../../hardcaml/Hardcaml/Interface/module-type-S/index.html">Hardcaml.Interface.S</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Simulator" class="anchored"><a href="#module-Simulator" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Simulator/index.html">Simulator</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A simulator for the design being tested.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-I_data" class="anchored"><a href="#module-I_data" class="anchor"></a><code><span><span class="keyword">module</span> <a href="I_data/index.html">I_data</a></span><span> : <a href="../../Digital_components/Data/module-type-S/index.html">Digital_components.Data.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../Digital_components/Data/module-type-S/index.html#type-t">t</a> = <span><a href="../../../hardcaml/Hardcaml/Bits/index.html#type-t">Hardcaml.Bits.t</a> <a href="I/index.html#type-t">I.t</a></span></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-O_data" class="anchored"><a href="#module-O_data" class="anchor"></a><code><span><span class="keyword">module</span> <a href="O_data/index.html">O_data</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span><span> = <span><span>( <span class="type-var">'a</span>, <a href="O_data/index.html#type-t">O_data.t</a>, <a href="I_data/index.html#type-t">I_data.t</a> )</span> <a href="../../Digital_components/Step_monad/index.html#type-t">Digital_components.Step_monad.t</a></span></span></code></div><div class="spec-doc"><p>A testbench takes the circuit's output as its input and produces its output as input for the circuit. An <code>'a t</code> describes a testbench computation that takes zero or more steps and produces a value of type <code>'a</code>.</p></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <span class="xref-unresolved">Hardcaml_step_testbench__</span>.Import.Monad.S <span class="keyword">with</span> <span><span class="keyword">type</span> <span>'a <span class="xref-unresolved">t</span></span> := <span><span class="type-var">'a</span> <span class="xref-unresolved">t</span></span></span></span></code></summary><div class="odoc-spec"><div class="spec value" id="val-(&gt;&gt;=)" class="anchored"><a href="#val-(&gt;&gt;=)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;&gt;=) : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-(&gt;&gt;|)" class="anchored"><a href="#val-(&gt;&gt;|)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;&gt;|) : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Monad_infix" class="anchored"><a href="#module-Monad_infix" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Monad_infix/index.html">Monad_infix</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bind" class="anchored"><a href="#val-bind" class="anchor"></a><code><span><span class="keyword">val</span> bind : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-return" class="anchored"><a href="#val-return" class="anchor"></a><code><span><span class="keyword">val</span> return : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-map" class="anchored"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-join" class="anchored"><a href="#val-join" class="anchor"></a><code><span><span class="keyword">val</span> join : <span><span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-ignore_m" class="anchored"><a href="#val-ignore_m" class="anchor"></a><code><span><span class="keyword">val</span> ignore_m : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-all" class="anchored"><a href="#val-all" class="anchor"></a><code><span><span class="keyword">val</span> all : <span><span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-all_unit" class="anchored"><a href="#val-all_unit" class="anchor"></a><code><span><span class="keyword">val</span> all_unit : <span><span><span>unit <a href="#type-t">t</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Let_syntax" class="anchored"><a href="#module-Let_syntax" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Let_syntax/index.html">Let_syntax</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></details></div><div class="odoc-spec"><div class="spec value" id="val-cycle" class="anchored"><a href="#val-cycle" class="anchor"></a><code><span><span class="keyword">val</span> cycle : 
  <span>?num_cycles:<span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
  <span><a href="I_data/index.html#type-t">I_data.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="O_data/index.html#type-t">O_data.t</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>cycle i_data ~num_cycles</code> waits for <code>num_cycles</code> cycles of the simulator to run, applying <code>i_data</code> to the simulator input ports, and returns the output computed in the final cycle. <code>cycle</code> raises if <code>num_cycles &lt; 1</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-for_" class="anchored"><a href="#val-for_" class="anchor"></a><code><span><span class="keyword">val</span> for_ : 
  <span><span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
    <span><span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Unit.t <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Unit.t <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>for_ i j f</code> does <code>f i</code>, <code>f (i+1)</code>, ... <code>f j</code> in sequence. If <code>j &lt; i</code>, then <code>for_ i
      j</code> immediately returns unit.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-delay" class="anchored"><a href="#val-delay" class="anchor"></a><code><span><span class="keyword">val</span> delay : 
  <span><a href="I_data/index.html#type-t">I_data.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>num_cycles:<span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Unit.t <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>delay inputs ~num_cycles</code> applies <code>inputs</code> for <code>num_cycles</code> clock cycles and then returns unit. <code>delay</code> raises if <code>num_cycles &lt; 0</code>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-finished_event" class="anchored"><a href="#type-finished_event" class="anchor"></a><code><span><span class="keyword">type</span> <span>('a, 'b) finished_event</span></span><span> =
  <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'b</span> )</span> <a href="../../Digital_components/Step_monad/Component_finished/index.html#type-t">Digital_components.Step_monad.Component_finished.t</a></span>
    <a href="../../Digital_components/Step_monad/Event/index.html#type-t">Digital_components.Step_monad.Event.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-spawn" class="anchored"><a href="#val-spawn" class="anchor"></a><code><span><span class="keyword">val</span> spawn : <span><span>( <span><a href="O_data/index.html#type-t">O_data.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>( <span class="type-var">'a</span>, <a href="I_data/index.html#type-t">I_data.t</a> )</span> <a href="#type-finished_event">finished_event</a></span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Launch a new task within the current simulation step.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-merge_inputs" class="anchored"><a href="#val-merge_inputs" class="anchor"></a><code><span><span class="keyword">val</span> merge_inputs : <span>parent:<a href="I_data/index.html#type-t">I_data.t</a> <span class="arrow">&#45;&gt;</span></span> <span>child:<a href="I_data/index.html#type-t">I_data.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="I_data/index.html#type-t">I_data.t</a></span></code></div><div class="spec-doc"><p><code>merge_inputs ~parent ~child</code> merges the child inputs into the parent. If a child input is <code>empty</code>, the parent's value is used.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-spawn_io" class="anchored"><a href="#val-spawn_io" class="anchor"></a><code><span><span class="keyword">val</span> spawn_io : 
  <span>inputs:<span>( <span>parent:<span class="type-var">'i</span> <span class="arrow">&#45;&gt;</span></span> <span>child:<a href="I_data/index.html#type-t">I_data.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'i</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>outputs:<span>( <span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../hardcaml/Hardcaml/Bits/index.html#type-t">Hardcaml.Bits.t</a> <a href="O/index.html#type-t">O.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><a href="O_data/index.html#type-t">O_data.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span>( <span class="type-var">'a</span>, <a href="I_data/index.html#type-t">I_data.t</a> )</span> <a href="#type-finished_event">finished_event</a></span>, <span><span class="type-var">'o</span> <a href="../Before_and_after_edge/index.html#type-t">Before_and_after_edge.t</a></span>, <span class="type-var">'i</span> )</span>
    <a href="../../Digital_components/Step_monad/index.html#type-t">Digital_components.Step_monad.t</a></span></span></code></div><div class="spec-doc"><p>Launch a task from a testbench with a <code>cycle</code> funtion taking <code>'i</code> to <code>'o</code>. The <code>inputs</code> and <code>outputs</code> arguments should construct <code>I_data.t</code> and <code>O_data.t</code> from the types of the child testbench.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-wait_for" class="anchored"><a href="#val-wait_for" class="anchor"></a><code><span><span class="keyword">val</span> wait_for : <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'b</span> )</span> <a href="#type-finished_event">finished_event</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Wait for the given event to occur, and extract its return value.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-wait_for_with_timeout" class="anchored"><a href="#val-wait_for_with_timeout" class="anchor"></a><code><span><span class="keyword">val</span> wait_for_with_timeout : 
  <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'b</span> )</span> <a href="#type-finished_event">finished_event</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>timeout_in_cycles:<span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Option.t</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Like <code>wait_for</code> except it stops waiting after <code>timeout_in_cycles</code> and returns <code>None</code>. Note that the spawned task continues to execute.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-input_hold" class="anchored"><a href="#val-input_hold" class="anchor"></a><code><span><span class="keyword">val</span> input_hold : <span><a href="../../../hardcaml/Hardcaml/Bits/index.html#type-t">Hardcaml.Bits.t</a> <a href="I/index.html#type-t">I.t</a></span></span></code></div><div class="spec-doc"><p>Call <code>run ~input_default:input_hold</code> to hold inputs their previous value if they are unset by tasks in the testbench.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-input_zero" class="anchored"><a href="#val-input_zero" class="anchor"></a><code><span><span class="keyword">val</span> input_zero : <span><a href="../../../hardcaml/Hardcaml/Bits/index.html#type-t">Hardcaml.Bits.t</a> <a href="I/index.html#type-t">I.t</a></span></span></code></div><div class="spec-doc"><p>Call <code>run ~input_default:input_zero</code> to set inputs to zero if unset by tasks in the testbench.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-run_with_timeout" class="anchored"><a href="#val-run_with_timeout" class="anchor"></a><code><span><span class="keyword">val</span> run_with_timeout : 
  <span>?input_default:<span><a href="../../../hardcaml/Hardcaml/Bits/index.html#type-t">Hardcaml.Bits.t</a> <a href="I/index.html#type-t">I.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>?show_steps:<span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Bool.t <span class="arrow">&#45;&gt;</span></span>
  <span>?timeout:<span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Unit.t <span class="arrow">&#45;&gt;</span></span>
  <span>simulator:<a href="Simulator/index.html#type-t">Simulator.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>testbench:<span>( <span><a href="O_data/index.html#type-t">O_data.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Option.t</span></span></code></div><div class="spec-doc"><p>Run the testbench until the main task finishes. The <code>input_default</code> argument controls what should happen if an input is unset by tasks in the testbench on any particular cycle. If a field is set to <code>Bits.empty</code> then the previous value should be held. Otherwise, the value provided is used as the default value for that field.</p><p>The optional timeout argument stops the simulation after the given number of steps and returns None. Otherwise it will continue until the testbech completes.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-run_until_finished" class="anchored"><a href="#val-run_until_finished" class="anchor"></a><code><span><span class="keyword">val</span> run_until_finished : 
  <span>?input_default:<span><a href="../../../hardcaml/Hardcaml/Bits/index.html#type-t">Hardcaml.Bits.t</a> <a href="I/index.html#type-t">I.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>?show_steps:<span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Bool.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Hardcaml_step_testbench__Import</span>.Unit.t <span class="arrow">&#45;&gt;</span></span>
  <span>simulator:<a href="Simulator/index.html#type-t">Simulator.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>testbench:<span>( <span><a href="O_data/index.html#type-t">O_data.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Run the testbench until completion.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-List" class="anchored"><a href="#module-List" class="anchor"></a><code><span><span class="keyword">module</span> <a href="List/index.html">List</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Array" class="anchored"><a href="#module-Array" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Array/index.html">Array</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>