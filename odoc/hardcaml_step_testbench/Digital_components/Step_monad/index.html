<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Step_monad (hardcaml_step_testbench.Digital_components.Step_monad)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">hardcaml_step_testbench</a> &#x00BB; <a href="../index.html">Digital_components</a> &#x00BB; Step_monad</nav><header class="odoc-preamble"><h1>Module <code><span>Digital_components.Step_monad</span></code></h1></header><div class="odoc-content"><div class="odoc-include"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>('a, 'i, 'o) t</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sexp_of_t" class="anchored"><a href="#val-sexp_of_t" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_t : 
  <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span class="type-var">'i</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <span class="xref-unresolved">Digital_components__</span>.Import.Monad.S3
  <span class="keyword">with</span> <span><span class="keyword">type</span> <span>('a, 'b, 'c) <span class="xref-unresolved">t</span></span> := <span><span>( <span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span> )</span> <span class="xref-unresolved">t</span></span></span></span></code></summary><div class="odoc-spec"><div class="spec value" id="val-(&gt;&gt;=)" class="anchored"><a href="#val-(&gt;&gt;=)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;&gt;=) : <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'b</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'b</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-(&gt;&gt;|)" class="anchored"><a href="#val-(&gt;&gt;|)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;&gt;|) : <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'b</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Let_syntax" class="anchored"><a href="#module-Let_syntax" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Let_syntax/index.html">Let_syntax</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Monad_infix" class="anchored"><a href="#module-Monad_infix" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Monad_infix/index.html">Monad_infix</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bind" class="anchored"><a href="#val-bind" class="anchor"></a><code><span><span class="keyword">val</span> bind : <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'b</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'b</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-return" class="anchored"><a href="#val-return" class="anchor"></a><code><span><span class="keyword">val</span> return : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-map" class="anchored"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'b</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-join" class="anchored"><a href="#val-join" class="anchor"></a><code><span><span class="keyword">val</span> join : <span><span><span>( <span><span>( <span class="type-var">'a</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'a</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-ignore_m" class="anchored"><a href="#val-ignore_m" class="anchor"></a><code><span><span class="keyword">val</span> ignore_m : <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( unit, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-all" class="anchored"><a href="#val-all" class="anchor"></a><code><span><span class="keyword">val</span> all : <span><span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> list</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-all_unit" class="anchored"><a href="#val-all_unit" class="anchor"></a><code><span><span class="keyword">val</span> all_unit : <span><span><span><span>( unit, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( unit, <span class="type-var">'d</span>, <span class="type-var">'e</span> )</span> <a href="#type-t">t</a></span></span></code></div></div></details></div><div class="odoc-spec"><div class="spec value" id="val-next_step" class="anchored"><a href="#val-next_step" class="anchor"></a><code><span><span class="keyword">val</span> next_step : 
  <span><span class="xref-unresolved">Digital_components__</span>.Import.Source_code_position.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span class="type-var">'i</span>, <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-thunk" class="anchored"><a href="#val-thunk" class="anchor"></a><code><span><span class="keyword">val</span> thunk : 
  <span><span>( <span><span class="xref-unresolved">Digital_components__Import</span>.Unit.t <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'a</span>, <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span class="type-var">'a</span>, <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-output_forever" class="anchored"><a href="#val-output_forever" class="anchor"></a><code><span><span class="keyword">val</span> output_forever : <span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">_</span>, <span class="type-var">_</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-for_" class="anchored"><a href="#val-for_" class="anchor"></a><code><span><span class="keyword">val</span> for_ : 
  <span><span class="xref-unresolved">Digital_components__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Digital_components__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span class="xref-unresolved">Digital_components__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
    <span><span>( <span class="xref-unresolved">Digital_components__Import</span>.Unit.t, <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span class="xref-unresolved">Digital_components__Import</span>.Unit.t, <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>for_ i j f</code> does <code>f i</code>, <code>f (i+1)</code>, ... <code>f j</code> in sequence. If <code>j &lt; i</code>, then <code>for_ i j</code> immediately returns unit.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-delay" class="anchored"><a href="#val-delay" class="anchor"></a><code><span><span class="keyword">val</span> delay : 
  <span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span>
  <span>num_steps:<span class="xref-unresolved">Digital_components__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span class="xref-unresolved">Digital_components__Import</span>.Unit.t, <span class="type-var">_</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>delay o ~num_steps</code> outputs <code>o</code> for <code>num_steps</code> and then returns unit. <code>delay</code> raises if <code>num_steps &lt; 0</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-repeat" class="anchored"><a href="#val-repeat" class="anchor"></a><code><span><span class="keyword">val</span> repeat : 
  <span>count:<span class="xref-unresolved">Digital_components__Import</span>.Int.t <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span class="xref-unresolved">Digital_components__Import</span>.Unit.t <span class="arrow">&#45;&gt;</span></span>
    <span><span>( <span class="xref-unresolved">Digital_components__Import</span>.Unit.t, <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span class="xref-unresolved">Digital_components__Import</span>.Unit.t, <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>repeat ~count f</code> does <code>f ()</code> <code>count</code> times. <code>repeat</code> raises if <code>count &lt; 0</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-wait" class="anchored"><a href="#val-wait" class="anchor"></a><code><span><span class="keyword">val</span> wait : 
  <span>output:<span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span>
  <span>until:<span>( <span><span class="type-var">'i</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Digital_components__Import</span>.Bool.t )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span class="xref-unresolved">Digital_components__Import</span>.Unit.t, <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Event" class="anchored"><a href="#module-Event" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Event/index.html">Event</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>An event is a value that will at some point in time (possibly the past, possibly the future) transition from &quot;undetermined&quot; to &quot;determined&quot;, with some value. One can <code>wait_for</code> an event in a computation.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-wait_for" class="anchored"><a href="#val-wait_for" class="anchor"></a><code><span><span class="keyword">val</span> wait_for : <span><span><span class="type-var">'a</span> <a href="Event/index.html#type-t">Event.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>output:<span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'a</span>, <span class="type-var">_</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>wait_for event ~output</code> outputs <code>output</code> until the step at which <code>event</code> becomes determined, at which point the <code>wait_for</code> proceeds.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Component_finished" class="anchored"><a href="#module-Component_finished" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Component_finished/index.html">Component_finished</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-spawn" class="anchored"><a href="#val-spawn" class="anchor"></a><code><span><span class="keyword">val</span> spawn : 
  <span>?update_children_after_finish:<span class="xref-unresolved">Digital_components__Import</span>.Bool.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Digital_components__</span>.Import.Source_code_position.t <span class="arrow">&#45;&gt;</span></span>
  <span>start:<span>( <span><span class="type-var">'i_c</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span>( <span class="type-var">'a</span>, <span class="type-var">'o_c</span> )</span> <a href="Component_finished/index.html#type-t">Component_finished.t</a></span>, <span class="type-var">'i_c</span>, <span class="type-var">'o_c</span> )</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>input:<span><span class="type-var">'i_c</span> <a href="../Data/index.html#type-t">Data.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>output:<span><span class="type-var">'o_c</span> <a href="../Data/index.html#type-t">Data.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>child_input:<span>( <span>parent:<span class="type-var">'i</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'i_c</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>include_child_output:<span>( <span>parent:<span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <span>child:<span class="type-var">'o_c</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'o</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'o_c</span> )</span> <a href="Component_finished/index.html#type-t">Component_finished.t</a></span> <a href="Event/index.html#type-t">Event.t</a></span>, <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>spawn</code> creates a child computation that runs <code>start</code>. <code>spawn</code> returns on the current step, and the child starts on the next step. The parent computation uses <code>child_input</code> to adjust its input into the form that the child computation sees, and <code>include_child_output</code> to incorporate the child's output into its output.</p><p>When <code>update_children_after_finish</code>, unfinished tasks spawned from within <code>start</code> will be executed even after <code>start</code> completes.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-create_component" class="anchored"><a href="#val-create_component" class="anchor"></a><code><span><span class="keyword">val</span> create_component : 
  <span>created_at:<span class="xref-unresolved">Digital_components__</span>.Import.Source_code_position.t <span class="arrow">&#45;&gt;</span></span>
  <span>update_children_after_finish:<span class="xref-unresolved">Digital_components__Import</span>.Bool.t <span class="arrow">&#45;&gt;</span></span>
  <span>start:<span>( <span><span class="type-var">'i</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span>( <span class="type-var">'a</span>, <span class="type-var">'o</span> )</span> <a href="Component_finished/index.html#type-t">Component_finished.t</a></span>, <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>input:<span><span class="type-var">'i</span> <a href="../Data/index.html#type-t">Data.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>output:<span><span class="type-var">'o</span> <a href="../Data/index.html#type-t">Data.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span class="type-var">'i</span>, <span class="type-var">'o</span> )</span> <a href="../Component/index.html#type-t">Component.t</a></span> * <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'o</span> )</span> <a href="Component_finished/index.html#type-t">Component_finished.t</a></span> <a href="Event/index.html#type-t">Event.t</a></span></span></code></div><div class="spec-doc"><p><code>create_component</code> creates a <code>Component.t</code> that runs the computation described by <code>start</code>. When <code>update_children_after_finish</code> is set to true, all component's children will be updated even after the child terminates. This will result in tasks spawned from within the child task to execute even after the child terminates.</p></div></div></div></div></body></html>