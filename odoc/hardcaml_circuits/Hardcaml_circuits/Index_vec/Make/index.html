<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make (hardcaml_circuits.Hardcaml_circuits.Index_vec.Make)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">hardcaml_circuits</a> &#x00BB; <a href="../../index.html">Hardcaml_circuits</a> &#x00BB; <a href="../index.html">Index_vec</a> &#x00BB; Make</nav><header class="odoc-preamble"><h1>Module <code><span>Index_vec.Make</span></code></h1><p>Index vector circuit with tracks indexes.</p></header><nav class="odoc-toc"><ul><li><a href="#parameters">Parameters</a></li><li><a href="#signature">Signature</a></li></ul></nav><div class="odoc-content"><h2 id="parameters"><a href="#parameters" class="anchor"></a>Parameters</h2><div class="odoc-spec"><div class="spec parameter" id="argument-1-X" class="anchored"><a href="#argument-1-X" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="argument-1-X/index.html">X</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="signature"><a href="#signature" class="anchor"></a>Signature</h2><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../module-type-S/index.html#type-tag">tag</a> := <span><a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a> <a href="../../../../hardcaml/Hardcaml/Interface/Empty/index.html#type-t">Hardcaml.Interface.Empty.t</a></span></span></span></code></summary><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div></div><h3 id="hardware-design-and-queries"><a href="#hardware-design-and-queries" class="anchor"></a>Hardware design and queries</h3><p>The vec is a small, growable array of elements. Elements may be inserted and removed from any position. Note that insertion and deletion shuffle elements up/down.</p><p>Unlike a normal data structure, it isn't supposed to hold the actual data. Instead it holds the index at which the data should reside. It should be connected to an external ram with the address connected to:</p><ul><li><code>insertion_index</code> when inserting</li><li><code>deletion_index</code> when deleting</li><li><code>access_index</code> (with the address on <code>op.slot</code> and <code>op.op=noop</code>) when you want to access the data at a slot.</li></ul><p>To insert an element, set <code>op.op = insert</code> and *during the same cycle* write the data to the (external) memory at <code>insertion_index</code>. Similarly to delete an element.</p><p>In some cases it is necessary to associate some extra bits that move with the indices - this can be done using tags. Tags may be changed (though the <code>tag_next</code> function) so long as the circuit is not currently inserting or deleting. To modify the tag value during insertion or deletion, see <code>insertion_tag</code> and <code>deletion_tag</code> in the type <code>Make_tagged.op</code> below.</p><div class="odoc-spec"><div class="spec value" id="val-indexes" class="anchored"><a href="#val-indexes" class="anchor"></a><code><span><span class="keyword">val</span> indexes : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a> <span class="xref-unresolved">Base</span>.array</span></span></code></div><div class="spec-doc"><p>Return an array of current indexes</p></div></div><div class="odoc-spec"><div class="spec value" id="val-index" class="anchored"><a href="#val-index" class="anchor"></a><code><span><span class="keyword">val</span> index : <span>at:<a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a></span></code></div><div class="spec-doc"><p>Get the index for the given position in the vec</p></div></div><div class="odoc-spec"><div class="spec value" id="val-tags" class="anchored"><a href="#val-tags" class="anchor"></a><code><span><span class="keyword">val</span> tags : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a> <a href="../../../../hardcaml/Hardcaml/Interface/Empty/index.html#type-t">Hardcaml.Interface.Empty.t</a></span> <span class="xref-unresolved">Base</span>.array</span></span></code></div><div class="spec-doc"><p>Return an array of current tags</p></div></div><div class="odoc-spec"><div class="spec value" id="val-tag" class="anchored"><a href="#val-tag" class="anchor"></a><code><span><span class="keyword">val</span> tag : 
  <span>at:<a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a> <a href="../../../../hardcaml/Hardcaml/Interface/Empty/index.html#type-t">Hardcaml.Interface.Empty.t</a></span></span></code></div><div class="spec-doc"><p>Get the tag for the given position in the vec</p></div></div><div class="odoc-spec"><div class="spec value" id="val-insertion_index" class="anchored"><a href="#val-insertion_index" class="anchor"></a><code><span><span class="keyword">val</span> insertion_index : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a></span></code></div><div class="spec-doc"><p>Index at which insertion will take place. It is valid _while_ the insert op is performed.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-deletion_index" class="anchored"><a href="#val-deletion_index" class="anchor"></a><code><span><span class="keyword">val</span> deletion_index : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a></span></code></div><div class="spec-doc"><p>Index at which deletion will take place. It is valid _while_ the delete op is performed.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-access_index" class="anchored"><a href="#val-access_index" class="anchor"></a><code><span><span class="keyword">val</span> access_index : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a></span></code></div><div class="spec-doc"><p>Index corresponding to <code>op.slot</code>.</p></div></div><h3 id="length-status"><a href="#length-status" class="anchor"></a>Length status</h3><p>The length is tracked during inserts and removes. To compute the length it tracks the insertion/deletion slot. Removing from an 'empty' slot does not decrease the size.</p><p>Using length is optional and probably not required unless treating the vec as a queue or stack (which can also be implemented more efficiently with a fifo like structure).</p><p><code>full</code> and <code>empty</code> are derived combinationally from <code>length</code>.</p><div class="odoc-spec"><div class="spec value" id="val-length" class="anchored"><a href="#val-length" class="anchor"></a><code><span><span class="keyword">val</span> length : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a></span></code></div><div class="spec-doc"><p>Length of the vec</p></div></div><div class="odoc-spec"><div class="spec value" id="val-full" class="anchored"><a href="#val-full" class="anchor"></a><code><span><span class="keyword">val</span> full : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a></span></code></div><div class="spec-doc"><p>Is the vec full?</p></div></div><div class="odoc-spec"><div class="spec value" id="val-empty" class="anchored"><a href="#val-empty" class="anchor"></a><code><span><span class="keyword">val</span> empty : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a></span></code></div><div class="spec-doc"><p>Is the vec empty?</p></div></div></details></div><div class="odoc-spec"><div class="spec type" id="type-op" class="anchored"><a href="#type-op" class="anchor"></a><code><span><span class="keyword">type</span> op</span><span> = </span><span>{</span></code><table><tr id="type-op.slot" class="anchored"><td class="def record field"><a href="#type-op.slot" class="anchor"></a><code><span>slot : <a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Slot to perform operation at</p><span class="comment-delim">*)</span></td></tr><tr id="type-op.op" class="anchored"><td class="def record field"><a href="#type-op.op" class="anchor"></a><code><span>op : <a href="../../../../hardcaml/Hardcaml/Signal/index.html#type-t">Hardcaml.Signal.t</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Operation type (insert, remove or nothing)</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>Operation performed on the <code>vec</code> circuit.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span><a href="../../../../hardcaml/Hardcaml/Reg_spec/index.html#type-t">Hardcaml.Reg_spec.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-op">op</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Create the vec with the given size.</p></div></div></div></body></html>